---
title: "Visualisation de donn√©es physiques"
subtitle: "Terrain 1 en g√©ographie (cohorte 2024)"
author: "Sarah-√àve Dionne & Audrey Campeau"
editor: visual
email: audrey.campeau@umontr√©al.ca
affiliation: "Department of Geography, Universit√© de Montr√©al"
lang: fr    

format:
  html:
    code-fold: true
    code-summary: "üëà Voir le code ici"
    toc: true
    toc-location: left
    toc-title: "Table of Content "
    number-sections: true
    embed-resources: true


fig-cap-location: margin
date: today
description: "Ce document comporte une courte analyse de donn√©es sur la chimie et la biologie des lacs des Laurentides. Ces donn√©es ont √©t√© r√©colt√©es par vous ü´µ"
title-block-banner: "#f0f3f5"
title-block-banner-color: "black"
css: style.css
---

![photo de groupe (A (gauche), B, (droite))](Groupe_photos_2.png)

# Comment parcourir ce document

-   L'objectif de ce document est de vous offrir une vue d'ensemble des donn√©es physiques collect√©es par chacun d'entre vous lors du cours Terrain I ü§ì

-   La table de mati√®re, situ√©e dans le coin en haut √† gauche üëà, vous permet de circuler ais√©ment √† travers les diff√©rentes sections.

-   L'usage des produits Plotly (une entreprise montr√©alaise üòé) vous permet d'interagir avec les diagrammes. Il suffit de passer le curseur sur l'image pour voir des d√©tails s'afficher, comme par exemple: le nom du lac, le nom de l'√©quipe responsable de l'√©chantillon ou des valeurs sp√©cifiques.

-   Les codes R se trouvent dans les menus d√©roulants sous l'onglet " üëà Voir le code ici"

-   Nous esp√©rons que notre travail vous inspirera √† vouloir utiliser la programmation R ü´∂üèª

-   Un monde de possibilit√© et de d√©couverte vous attend! ü§©

# Tableau \| Base de donn√©es commune

Ce tableau contient toutes les donn√©es recueillie par les 6 √©quipes du groupe A et B. Ensemble, nous avons √©chantillonn√© 10 lacs diff√©rents, pour un total de 66 observations. üëè

Ces lacs incluent 3 lacs prot√©g√© dans le secteur de la SBL (lac Croche, Cromwell, Triton et Geai) et 6 lacs anthropis√©, hors de la SBL.

Nous avons mesur√© plusieurs variables, portant sur la chimie de l'eau, la communaut√© de zooplancton, et les √©missions de CO‚ÇÇ vers l'atmosph√®re

```{r, warning=FALSE, message=FALSE}

# Importer les libraries dont nous avons besoin
library(tidyverse) # librairie de visualisation de donn√©es
library(plotly) # permet de rendre les diagrammes interactifs
library(readxl) # permet d'ouvrir des fichier excel
library(DT) # produit des tableau interactifs

# Ouvrir la base de donn√©es commune
data <- read_xlsx("../Data/donnees_td_edited.xlsx") # ouvrir la base de donn√©es

data$Date=as.Date(data$Date) # formater les dates

theme_set(theme_bw(base_size = 14)) #sp√©cifier le th√®me des diagrammes

datatable(data, options = list(pageLength = 5), filter="top") %>%  
  formatStyle(columns = colnames(.$x$data), `font-size` = '12px')


```

# Carte \| O√π avons-nous √©chantillonn√©?

Gr√¢ce a cette carte, vous pouvez identifier vos sites d'√©chantillonnage et rep√©rer ceux de vos coll√®gues √©galement. Les √©quipes du groupe A sont identifi√©es avec les cercles mauves, alors que celles du groupe B le sont avec des cercles oranges.

```{r, warning=F, message=F}

library(leaflet)
library(htmltools)

carte=leaflet(data = data) %>%
   addTiles() %>%

   addCircleMarkers(
      ~LONGITUDE, ~LATITUDE, 
      radius=~5 , 
      color= c(rep("purple", 25), rep("orange",41)),
      label = ~htmlEscape(√âQUIPE),
      stroke = T, 
      fillOpacity = 0.8
          ) 
carte

```

# Diagramme √† moustache \| Conductivit√© l'eau

La conductivit√© de l'eau repr√©sente sa capacit√© a conduire le courant √©lectrique. Elle est directement li√©r √† la quantit√© d'ions dissous dans l'eau. L'√©pandage de sel sur les routes en hiver cr√©er un apport √©lev√© en sel (ions Na+ et Cl-) dans les eaux de ruissellement qui finissent par se jeter dans les lacs. La conductivit√© de l'eau √©tait en moyenne 5 fois plus elev√©e dans les lacs √† l'ext√©rieur qu'√† l'int√©rieur de la SBL.

```{r,warning=F}
boxplot= ggplot(data=data,
         aes(x = SECTEUR, y = Conductivite, fill = SECTEUR,
              labels = NOM_DU_LAC, text=√âQUIPE)) +
  geom_boxplot() +
  geom_jitter()+
  scale_fill_manual(values = c("SBL" = "#1984c5", "HSBL" = "#c23728")) +  
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(size = 11)
  ) +
  ggtitle("") +
  xlab("Secteurs") +
  ylab("Conductivit√© (uS/cm)")

ggplotly(boxplot, tooltip = c("y", "labels", "text"))


```

## Nuage de point \| Conductivit√© de l'eau

Le ratio de drainage (aire du bassin versant / aire du lac) ne semble pas avoir d'impact sur la conductivit√© de l'eau pour les lacs dans la SBL, mais il semble √™tre n√©gativement corr√©l√© a celui de la conductivit√© dans les lacs hors de la SBL. Un lac avec un grand ratio de drainage a un grand bassin versant par rapport √† sa superficie. Par exemple, on observe que le lac rond avait la conductivit√© la plus √©lev√©e, autant lors de l'√©chantillonnage du groupe A que B.

G√©n√©ralement, on observe la relation contraire pour l'apport en nutriment, phosphore et azote! Cela pourrait √™tre d√ª √† un effet de dilution (les lacs avec de grands ratios de drainage stockent g√©n√©ralement un plus large volume d'eau) ou d√ª √† la configuration du r√©seau routier autour des lacs. Il y a aussi des diff√©rences entre le moment de la fonte entre ces lacs qui pourrait jouer un r√¥le.

```{r, warning =F, message=FALSE}
#nuage de point 
scatterplot <- ggplot(data=data,
               aes(x = Ratio_Drainage, y = Conductivite, 
                  fill = SECTEUR, labels = NOM_DU_LAC, text=√âQUIPE)) + 
                geom_smooth()+
                geom_point(size = 3) +
                scale_shape_manual(values=c(21,23))+
                scale_fill_manual(values = c("SBL" = "#1984c5", "HSBL" = "#c23728")) +
                scale_x_continuous(limits = c(0, NA)) +
                labs(
                  title = "",
                  x = "Ratio de drainage",
                  y = "Conductivit√© (uS/cm)"
                )+
              theme(plot.title = element_text(size = 11))

ggplotly(scatterplot,tooltip = c("labels", "text"))
```

# Diagramme de densit√© \| Zooplancton

Malgr√© que plusieurs √©tudes indiquent que la pr√©sence humaine aux abords d'un lac a un impact direct sur la richesse sp√©cifique de la communaut√© de zooplancton des lacs, nos donn√©es ne semblent pas confirmer cet effet. Le nombre d'esp√®ces de zooplancton identifi√© dans les lacs hors de la SBL est similaire √† ceux de la SBL. (ce graphique n'est pas interactif)

```{r, warning=FALSE, message=F}
library(ggridges)

ridgeplotA= ggplot(data=data,
                   aes(x=Richesse_Sp√©cifique)) +
  geom_density()+
   geom_dotplot(aes(fill=factor(GROUPE), labels=√âQUIPE), 
                stackgroups = TRUE, binwidth = 1, binaxis = "x",
                binpositions = "all", dotsize = 1, method="histodot", alpha=0.5)+
  scale_fill_manual(values = c("purple", "orange"))+ 
  theme( plot.title = element_text(size = 11)) +
  scale_x_continuous(breaks=seq(0,10,1))+
  xlab("Richesse Sp√©cifique du Zooplancton")+
  labs(fill = "GROUPE") +
  scale_y_continuous(NULL, breaks = NULL, limits=c(0,0.25))+
  facet_wrap(~SECTEUR, scales = "fixed")

ridgeplotA



```

# Diagramme de sucette \| Flux de CO‚ÇÇ

Malgr√© quelques difficult√©s techniques lors de la deuxi√®me semaine, les donn√©es des chambres flottantes indiquent que certains lacs √©taient bel et bien de grandes sources de CO‚ÇÇ vers l'atmosph√®re (p.ex Triton) alors que d'autres √©taient de faibles puits de CO‚ÇÇ (p.ex Croche et Connely)

```{r, warning=F, message=F}

# R√©organiser les donn√©es
data_loli = data %>% 
  rowwise() %>% 
  group_by(NOM_DU_LAC)%>%
  summarise( mean = mean(Flux_CO2, na.rm = T),
          min = min(Flux_CO2,na.rm = T),
          max = max(Flux_CO2,na.rm = T)) #%>% 


# Faire le graphique
cleveland_dotplot=ggplot() +
  geom_abline(x=0)+
  geom_segment(data=data_loli, aes(x=NOM_DU_LAC, xend=NOM_DU_LAC, 
                    y=min, yend=max), color="grey") +
  
  geom_point(data=data%>% filter(GROUPE == "A"), 
             aes(x=NOM_DU_LAC, y=Flux_CO2, label=√âQUIPE), 
             color="purple", size=3 ) +
  
  geom_point(data=data%>% filter(GROUPE == "B"), 
             aes(x=NOM_DU_LAC, y=Flux_CO2,label=√âQUIPE), 
             color="orange", size=3 ) +
  
  coord_flip()+

  ylab("Flux de CO2 (mg C /m2 /jr)")+
  xlab("Nom du lac")

  

ggplotly(cleveland_dotplot, tooltip = c("label", "y"))

```
